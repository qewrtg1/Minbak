<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>메시지</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .message-container { height: 100vh; }
    .message-list { background-color: #f8f9fa; padding: 15px; overflow-y: auto; border-right: 1px solid #ddd; }
    .chat-content { background-color: #fff; padding: 15px; }
    .user-item { padding: 10px; cursor: pointer; border-bottom: 1px solid #ddd; display: flex; align-items: center; }
    .user-item:hover { background-color: #e9ecef; }

    /* 유저 리스트 항목에 대한 스타일 */
    .user-box {
      cursor: pointer;
      background-color: #f8f9fa; /* 기본 배경색 */
      transition: background-color 0.3s ease; /* 부드러운 전환 효과 */
      display: flex;
      align-items: center;
      padding: 10px;
      border-radius: 5px;
    }

    .user-box:hover {
      background-color: #e9ecef; /* 마우스를 올렸을 때 배경색 */
    }

    .chat-messages { height: 65vh; overflow-y: auto; padding: 10px; }
    .message { padding: 10px; border-radius: 10px; margin-bottom: 10px; max-width: 75%; }
    .received { background-color: #f1f1f1; align-self: flex-start; }
    .sent { background-color: #007bff; color: white; align-self: flex-end; }
    .chat-input { margin-top: 15px; display: flex; }
    .chat-input input { flex-grow: 1; margin-right: 10px; }
    .chat-header { border-bottom: 1px solid #ddd; padding-bottom: 10px; margin-bottom: 10px; }
  </style>
</head>
<body>
<div class="container-fluid">
  <div class="row message-container">
    <!-- 왼쪽 패널 (유저 메시지 목록) -->
    <div class="col-3 message-list">
      <div class="d-flex justify-content-between align-items-center">
        <h4>메시지</h4>
        <div>
          <button class="btn btn-dark btn-sm">전체</button>
          <button class="btn btn-outline-dark btn-sm">읽지 않음</button>
        </div>
      </div>
      <div class="user-list mt-3">
        <div th:each="userMessageList, iterStat : ${userMessageLists}"
             th:attr="data-chat-id=${userMessageList.chatRoomId}"
             onclick="loadChat(this)"
             class="user-box"
        style="cursor: pointer;">

        <!-- Profile Image -->
        <img th:src="@{${detailUserResponseLists[iterStat.index].profileImageUrl}}" alt="User Icon" width="40" height="40" class="me-3 rounded-circle" style="pointer-events: none;">

        <!-- User Info -->
        <div class="d-flex flex-column">
          <h6 th:text="${userMessageList.ChatRoomUserName}" class="mb-1">유저 이름</h6>
          <p class="text-muted small mb-0" th:text="${userMessageList.lastMessageContent}">마지막 메시지</p>
        </div>

        <!-- Time -->
        <span class="text-muted small ms-auto" th:text="${#temporals.format(userMessageList.lastMessageTime, 'yyyy년 M월 d일 HH시 mm분 ss초')}">2.20.</span>
      </div>
    </div>
  </div>

  <!-- 중앙 패널 (대화 내용) -->
  <!-- 대화 내용은 주석 처리되어 있으며, 필요한 경우 활성화할 수 있습니다 -->
</div>
</div>

<script>
  function loadChat(element) {
      let chatRoomId = element.getAttribute("data-chat-id");
      window.location.href = '/user/messageList/' + chatRoomId;
  }
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
