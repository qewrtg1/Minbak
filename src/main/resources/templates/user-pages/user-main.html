
<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml">
<head>
  <meta charset="UTF-8">
  <title>ìˆ™ì†Œ ë©”ì¸ í˜ì´ì§€</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* ì»¨í…Œì´ë„ˆ ë„ˆë¹„ ì¡°ì • (ì¢Œìš° ì—¬ë°± ì¤„ì´ê¸°) */
    .container {
        max-width: 90%;
    }
    /* âœ… ê²€ìƒ‰ì°½ ìŠ¤íƒ€ì¼ */
    .search-bar {
        display: flex;
        align-items: center;
        justify-content: space-between;
        background: white;
        padding: 12px 20px;
        border-radius: 50px;
        box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
        max-width: 700px;
        margin: 30px auto;
    }

    .search-input {
        flex: 1;
        border: none;
        outline: none;
        font-size: 14px;
        color: #333;
        padding: 5px 10px;
        background: transparent;
    }

    .search-button {
        background: #ff385c;
        color: white;
        border: none;
        padding: 10px 14px;
        border-radius: 50%;
        font-size: 16px;
        cursor: pointer;
    }

    .search-button:hover {
        background: #e12b50;
    }

    /* âœ… ì¹´í…Œê³ ë¦¬ ë°” ìŠ¤íƒ€ì¼ */
    .category-container {
        display: flex;
        flex-wrap: nowrap; /* ì¤„ë°”ê¿ˆ ë°©ì§€ */
        overflow-x: hidden; /* ğŸ”¥ Xì¶• ìŠ¤í¬ë¡¤ë°” ì™„ì „ ì œê±° */
        scrollbar-width: none; /* Firefox */
        -webkit-overflow-scrolling: touch;
        width: 100%;
        gap: 15px;
    }

    .category-container::-webkit-scrollbar {
        display: none; /* ğŸ”¥ Chrome, Safari ë“±ì—ì„œ ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¹€ */
    }


    .category-container::-webkit-scrollbar-thumb {
        background-color: #ccc;
        border-radius: 10px;
    }

    .category-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 10px;
        font-size: 14px;
        cursor: pointer;
        min-width: 100px; /* ìµœì†Œ í¬ê¸° ì„¤ì • */
        text-align: center;
        flex-shrink: 0; /* í¬ê¸° ì¤„ì–´ë“¤ì§€ ì•Šë„ë¡ ì„¤ì • */
    }

    .category-item i {
        font-size: 20px;
        margin-bottom: 5px;
    }

    /* ì„ íƒëœ ì¹´í…Œê³ ë¦¬ ê°•ì¡° */
    .category-item.active {
        font-weight: bold;
        border-bottom: 2px solid black;
    }

    .card {
        width: 100%;
        height: auto; /* ê°€ë³€ í¬ê¸° */
        font-size: 14px;
    }

    .card-img-top {
        width: 100%;
        height: 160px; /* ì´ë¯¸ì§€ ë†’ì´ ì¡°ì • */
        object-fit: cover;
    }

    .carousel-item img {
        width: 100%;
        height: 160px;
        object-fit: cover;
    }

    /* ë¦¬ë·° ìŠ¤íƒ€ì¼ */
    .review-box {
        background-color: #f8f9fa;
        padding: 8px;
        border-radius: 5px;
        font-size: 12px;
        margin-top: 5px;
    }

    /* âœ… ìŠ¤í¬ë¡¤ ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ */
    .scroll-container {
        display: flex;
        align-items: center;
        position: relative;
        justify-content: space-between;
    }

    /* âœ… í•„í„° ë²„íŠ¼ ìŠ¤íƒ€ì¼ (ì˜¤ë¥¸ìª½ ëìœ¼ë¡œ ì´ë™) */
    .filter-button {
        background: white;
        border: 1px solid #ddd;
        border-radius: 20px;
        padding: 8px 15px;
        font-size: 14px;
        display: flex;
        align-items: center;
        gap: 5px;
        cursor: pointer;
        box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.1);
        position: absolute;
        right: -10px; /* ğŸ”¥ ì˜¤ë¥¸ìª½ ëìœ¼ë¡œ ì´ë™ */
        top: 50%;
        transform: translateY(-50%);
        z-index: 12; /* í•„í„° ë²„íŠ¼ì´ ê°€ì¥ ìœ„ì— ìˆë„ë¡ ì„¤ì • */
    }

    /* âœ… ìŠ¤í¬ë¡¤ ë²„íŠ¼ ìœ„ì¹˜ ì¡°ì • (ê²¹ì¹¨ ë°©ì§€) */
    .scroll-button {
        background: white;
        border: 1px solid #ddd;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.1);
        position: absolute;
        z-index: 11;
    }

    /* ì™¼ìª½ ë²„íŠ¼ ìœ„ì¹˜ */
    .scroll-button.left {
        left: -50px;
    }

    /* ì˜¤ë¥¸ìª½ ë²„íŠ¼ ìœ„ì¹˜ (í•„í„° ë²„íŠ¼ê³¼ ê²¹ì¹˜ì§€ ì•Šë„ë¡ ì¡°ì •) */
    .scroll-button.right {
        right: 70px;  /* ğŸ”¥ í•„í„° ë²„íŠ¼ë³´ë‹¤ ì™¼ìª½ìœ¼ë¡œ ì´ë™ */
    }

    /* âœ… ì¹´í…Œê³ ë¦¬ ë°” ë„ˆë¹„ ì¡°ì • */
    .category-container {
        display: flex;
        flex-wrap: nowrap;
        overflow-x: hidden;
        scrollbar-width: none;
        -webkit-overflow-scrolling: touch;
        max-width: calc(100% - 120px); /* ğŸ”¥ í•„í„° ë²„íŠ¼ê³¼ ìŠ¤í¬ë¡¤ ë²„íŠ¼ ê³ ë ¤í•˜ì—¬ ìë™ ë„ˆë¹„ ì¡°ì • */
        gap: 15px;
    }

    .category-container::-webkit-scrollbar {
        display: none;
    }

    /* âœ… ì¹´í…Œê³ ë¦¬ ì•„ì´ì½˜ í¬ê¸° ì¡°ì • */
    .category-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 10px;
        font-size: 14px;
        cursor: pointer;
        min-width: 90px;
        text-align: center;
        flex-shrink: 0;
    }

    .category-item i {
        font-size: 20px;
        margin-bottom: 5px;
    }
    .room-link {
      text-decoration: none; /* ë°‘ì¤„ ì œê±° */
      color: inherit;        /* ë¶€ëª¨ ìš”ì†Œ(í˜¹ì€ ê¸°ë³¸ í…ìŠ¤íŠ¸) ìƒ‰ìƒ ìƒì† */
    }

    .room-link:hover,
    .room-link:focus,
    .room-link:visited {
      text-decoration: none; /* í˜¸ë²„, í¬ì»¤ìŠ¤, ë°©ë¬¸í•œ ë§í¬ ìƒíƒœì—ì„œë„ ë°‘ì¤„ ì œê±° */
      color: inherit;        /* ë§í¬ ìƒ‰ìƒë„ ê¸°ë³¸ í…ìŠ¤íŠ¸ ìƒ‰ìƒ ìœ ì§€ */
    }

  </style>
</head>
<body>

<!--í—¤ë”-->
<div th:replace="~{user-pages/common/header}"></div>

<!-- âœ… ê²€ìƒ‰ì°½ -->
<div class="search-bar">
  <input type="text" class="search-input" placeholder="ì—¬í–‰ì§€ ê²€ìƒ‰">
  <input type="text" class="search-input" placeholder="ì²´í¬ì¸ ë‚ ì§œ ì¶”ê°€">
  <input type="text" class="search-input" placeholder="ì²´í¬ì•„ì›ƒ ë‚ ì§œ ì¶”ê°€">
  <input type="text" class="search-input" placeholder="ê²ŒìŠ¤íŠ¸ ì¶”ê°€">
  <button class="search-button"><i class="fa fa-search"></i></button>
</div>

<!-- ì¹´í…Œê³ ë¦¬ ë°” -->
<div class="container mt-3 position-relative" id="category-wrapper">
  <div class="scroll-container">
    <button class="scroll-button left" onclick="scrollCategory('left')">
      <i class="fa fa-chevron-left"></i>
    </button>

    <div class="category-container" id="category-buttons">
      <!-- ë™ì ìœ¼ë¡œ ì¹´í…Œê³ ë¦¬ ì¶”ê°€ -->
    </div>

    <button class="scroll-button right" onclick="scrollCategory('right')">
      <i class="fa fa-chevron-right"></i>
    </button>
  </div>

  <!-- âœ… í•„í„° ë²„íŠ¼ì„ ìŠ¤í¬ë¡¤ ë²„íŠ¼ê³¼ ê²¹ì¹˜ì§€ ì•Šë„ë¡ ì¡°ì • -->
  <button class="filter-button">
    <i class="fa fa-sliders"></i> í•„í„°
  </button>
</div>

<!-- ìˆ™ì†Œ ëª©ë¡ -->
<div class="container mt-4">
  <div class="row" id="rooms-container">
    <!-- JavaScriptê°€ ìˆ™ì†Œ ëª©ë¡ì„ ë™ì ìœ¼ë¡œ ì¶”ê°€ -->
  </div>
</div>

<!-- Bootstrap ë° JavaScript -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
      fetch("/main") // ì„œë²„ì—ì„œ JSON ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
          .then(response => response.json())
          .then(data => {
              displayCategories(data.categories);
              displayRooms(data.rooms);
          })
          .catch(error => console.error("ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ì˜¤ë¥˜:", error));
  });

  // ì¹´í…Œê³ ë¦¬ ì•„ì´ì½˜ ë§¤í•‘
  const categoryIcons = {
      "ì¸ê¸° ìˆ™ì†Œ": "fa-star",
      "ì œì£¼ í•œë‹¬ì‚´ê¸°": "fa-umbrella-beach",
      "í†µë‚˜ë¬´ì§‘": "fa-tree",
      "ìº í•‘": "fa-campground",
      "ì¹´ë¼ë°˜": "fa-caravan",
      "ë„ì‹œ": "fa-city",
      "ì‹œê³¨": "fa-house-chimney",
      "ìˆ²": "fa-leaf",
      "ê³¨í”„": "fa-golf-ball-tee",
      "í•œì˜¥": "fa-landmark",
      "ì„¬": "fa-water",
      "í‚¤ì¦ˆ": "fa-child",
      "ì „í†µ": "fa-balance-scale",
      "í˜¸ìˆ˜": "fa-water",
      "ê³ ê¸‰": "fa-gem",
      "ì‚°": "fa-mountain",
      "ë°”ë‹¤": "fa-water",
      "ë…íŠ¹í•œ í…Œë§ˆ": "fa-paint-brush",
      "ìˆ˜ì˜ì¥": "fa-swimmer",
      "ìŠ¤í‚¤ì¥": "fa-skiing",
      "ì„œí•‘": "fa-water",
      "ë°˜ë ¤ë™ë¬¼": "fa-paw"
  };

  // ì¹´í…Œê³ ë¦¬ ë²„íŠ¼ ìƒì„±
  function displayCategories(categories) {

      const categoryContainer = document.getElementById("category-buttons");

      categories.forEach(category => {
          const categoryDiv = document.createElement("div");
          categoryDiv.className = "category-item";
          categoryDiv.innerHTML = `
              <i class="fa ${categoryIcons[category.name] || 'fa-home'}"></i>
              ${category.name}
          `;
          categoryDiv.onclick = () => filterRooms(category.name);
          categoryContainer.appendChild(categoryDiv);
      });
  }

  //ìŠ¤í¬ë¡¤ì ìš©
  function scrollCategory(direction) {
      const container = document.getElementById("category-buttons");
      const scrollAmount = 300; // ì´ë™ ê±°ë¦¬(px)

      if (direction === "left") {
          container.scrollBy({ left: -scrollAmount, behavior: "smooth" });
      } else {
          container.scrollBy({ left: scrollAmount, behavior: "smooth" });
      }
  }

  function displayRooms(rooms) {
    const roomsContainer = document.getElementById("rooms-container");
    roomsContainer.innerHTML = ""; // ê¸°ì¡´ ëª©ë¡ ì´ˆê¸°í™”

    rooms.forEach(room => {
      const card = document.createElement("div");
      card.className = "col-md-3 mb-4"; // í•œ ì¤„ì— 4ê°œì”© ë°°ì¹˜

      // ì´ë¯¸ì§€ ì •ë³´ê°€ ê°ì²´ì¸ì§€ ë°°ì—´ì¸ì§€ í™•ì¸í•˜ê³ , ë‹¨ì¼ ì´ë¯¸ì§€ URL ì¶”ì¶œ
      let imageUrl = "/images/no-image.jpg"; // ê¸°ë³¸ ì´ë¯¸ì§€
      if (room.images) {
        if (Array.isArray(room.images)) {
          // ë°°ì—´ì´ë©´ ì²« ë²ˆì§¸ ì´ë¯¸ì§€ ì‚¬ìš© (ë§Œì•½ ë°°ì—´ì— ê°’ì´ ìˆë‹¤ë©´)
          if (room.images.length > 0) {
            imageUrl = room.images[0].fileUrl;
          }
        } else {
          // ë°°ì—´ì´ ì•„ë‹ˆë¼ë©´, ê°ì²´ í˜•íƒœë¡œ ë‚´ë ¤ì˜¨ ê²ƒìœ¼ë¡œ ê°€ì •
          imageUrl = room.images.fileUrl || imageUrl;
        }
      }

      card.innerHTML = `
        <a href="/room/${room.roomId}" class="room-link">
          <div class="card">
            <!-- ë‹¨ì¼ ì´ë¯¸ì§€ í‘œì‹œ -->
            <img src="${imageUrl}" class="card-img-top" alt="ìˆ™ì†Œ ì´ë¯¸ì§€" />
            <div class="card-body">
              <h6 class="card-title">${room.title}</h6>
              <p class="card-text">${room.address}</p>
              <p class="card-text"><strong>â‚©${room.price.toLocaleString()} / ë°•</strong></p>
              <p class="card-text">â­ ${room.reviewScore} (ë¦¬ë·° ${room.reviewCount}ê°œ)</p>
              ${room.recentReview ? `
                <div class="review-box">
                  <p><strong>${room.recentReview.userName}</strong>: ${room.recentReview.content} (â­ ${room.recentReview.score})</p>
                </div>
              ` : ""}
            </div>
          </div>
        </a>
      `;
      roomsContainer.appendChild(card);
    });
  }


  function filterRooms(category) {
      console.log(category + " í•„í„° ì ìš©ë¨ (í•„í„° ê¸°ëŠ¥ ì¶”ê°€ í•„ìš”)");
  }
</script>

</body>
</html>
