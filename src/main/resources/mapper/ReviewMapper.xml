<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.minbak.web.review.ReviewMapper">


    <!-- 리뷰 목록 조회 -->
    <select id="getAllReviews" resultType="com.minbak.web.review.ReviewDto">
        <!-- 모든 리뷰를 조회하는 쿼리 -->
        SELECT
        review_id AS reviewId,    <!-- 리뷰 고유 ID -->
        user_id AS userId,        <!-- 작성자 회원 ID -->
        book_id AS bookId,        <!-- 리뷰 대상 예약 ID -->
        content AS content,       <!-- 리뷰 내용 -->
        score AS score            <!-- 리뷰 점수 -->
        FROM review
    </select>

    <!-- 리뷰 상세 조회 (특정 리뷰 조회) -->
    <select id="getReviewById" resultType="com.minbak.web.review.ReviewDto">
        <!-- 특정 리뷰 ID를 기준으로 리뷰 하나를 조회하는 쿼리 -->
        SELECT
        review_id AS reviewId,    <!-- 리뷰 고유 ID -->
        user_id AS userId,        <!-- 작성자 회원 ID -->
        book_id AS bookId,        <!-- 리뷰 대상 예약 ID -->
        content AS content,       <!-- 리뷰 내용 -->
        score AS score            <!-- 리뷰 점수 -->
        FROM review
        WHERE review_id = #{reviewId}   <!-- 리뷰 ID로 조건을 걸어 특정 리뷰만 조회 -->
    </select>

    <!-- 리뷰 수정 -->
    <update id="updateReview">
        <!-- 리뷰의 내용을 수정하는 쿼리 -->
        UPDATE review
        SET
        content = #{content},    <!-- 리뷰 내용 수정 -->
        score = #{score},        <!-- 리뷰 점수 수정 -->
        updated_at = NOW()       <!-- 수정 시 현재 시간으로 updated_at을 갱신 (자동으로 수정된 시간을 기록) -->
        WHERE review_id = #{reviewId}   <!-- 리뷰 ID로 특정 리뷰를 찾아 수정 -->
    </update>

    <!-- 리뷰 삭제 -->
    <delete id="deleteReview">
        <!-- 특정 리뷰를 삭제하는 쿼리 -->
        DELETE FROM review
        WHERE review_id = #{reviewId}   <!-- 리뷰 ID로 조건을 걸어 삭제할 리뷰를 특정 -->
    </delete>

</mapper>